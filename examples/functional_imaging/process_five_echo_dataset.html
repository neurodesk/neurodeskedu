
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>tedana: TE Dependent ANAlysis &#8212; Neurodesk</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/functional_imaging/process_five_echo_dataset';</script>
    <link rel="canonical" href="https://neurodesk.org/edu/examples/functional_imaging/process_five_echo_dataset.html" />
    <link rel="icon" href="../../_static/neurodesk_logo.svg"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Spectroscopy" href="../spectroscopy/intro.html" />
    <link rel="prev" title="FreeSurfer: mri_vol2surf" href="mri_vol2surf.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/neurodesk_logo.svg" class="logo__image only-light" alt="Neurodesk - Home"/>
    <script>document.write(`<img src="../../_static/neurodesk_logo.svg" class="logo__image only-dark" alt="Neurodesk - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../intro.html">Examples</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../diffusion_imaging/intro.html">Diffusion Imaging</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../diffusion_imaging/DIPY_1.html">Basic Tracking with DIPY</a></li>
<li class="toctree-l3"><a class="reference internal" href="../diffusion_imaging/DIPY_2.html">Advanced Tracking with DIPY</a></li>
<li class="toctree-l3"><a class="reference internal" href="../diffusion_imaging/Diffusion_TBSS_Demo.html">TBSS Tutorial</a></li>


<li class="toctree-l3"><a class="reference internal" href="../diffusion_imaging/MRtrix_1.html">MRtrix: Part 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../diffusion_imaging/MRtrix_2.html">MRtrix: Part 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../diffusion_imaging/MRtrix_3.html">MRtrix: Part 3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../diffusion_imaging/mrtrix3tissue.html">MRtrix3Tissue</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../electrophysiology/intro.html">Electrophysiology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../electrophysiology/eeg_with_mne.html">EEG Analysis with MNE</a></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="intro.html">Functional Imaging</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="AFNI_preprocessing_only.html">AFNI Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_preprocessing_plus_glm.html">AFNI Preprocessing and GLM</a></li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_preprocessing_plus_glm_group.html">AFNI Preprocessing &amp; Group Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_processing_task_based.html">Processing task-based FMRI with AFNI and afni_proc.py</a></li>



<li class="toctree-l3"><a class="reference internal" href="FSL_preproc_glm.html">FSL Preprocessing and GLM</a></li>
<li class="toctree-l3"><a class="reference internal" href="FSLnets_course_practical.html">Resting state with FSLnets</a></li>
<li class="toctree-l3"><a class="reference internal" href="NiWrap.html">NiWrap and Connectome Workbench</a></li>
<li class="toctree-l3"><a class="reference internal" href="aslprep.html">ASLprep</a></li>
<li class="toctree-l3"><a class="reference internal" href="deepretinotopy.html">DeepRetinotopy Toolbox</a></li>
<li class="toctree-l3"><a class="reference internal" href="first_and_second_level_spm.html">Nipype-SPM fMRI Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmriprep.html">fMRIprep</a></li>
<li class="toctree-l3"><a class="reference internal" href="fsl_all_levels_flanker_nipype.html">Nipype-FSL fMRI Analysis</a></li>



<li class="toctree-l3"><a class="reference internal" href="intro_to_preprocessing.html">Introduction to Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="mri_vol2surf.html">FreeSurfer: mri_vol2surf</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">tedana: TE Dependent ANAlysis</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spectroscopy/intro.html">Spectroscopy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spectroscopy/lcmodel.html">MR Spectroscopy with LCModel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spectroscopy/osprey.html">MR Spectroscopy with Osprey</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../structural_imaging/intro.html">Structural Imaging</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../structural_imaging/FSL_course_bet.html">FSL course - BET</a></li>
<li class="toctree-l3"><a class="reference internal" href="../structural_imaging/brain_extraction_different_tools.html">Brain Extraction Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../structural_imaging/freesurfer-recon-all-clinical.html">FreeSurfer: recon-all-clinical</a></li>

<li class="toctree-l3"><a class="reference internal" href="../structural_imaging/freesurfer.html">FreeSurfer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../structural_imaging/qsmxt.html">QSMxT</a></li>







<li class="toctree-l3"><a class="reference internal" href="../structural_imaging/sct_toolbox.html">SCT Toolbox</a></li>

</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../workflows/intro.html">Workflows</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../workflows/AA_Neurodesk_demo_tour.html">Neurodesk Tools Demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflows/MRIQC.html">MRIQC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflows/PyBIDS.html">PyBIDS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflows/RISE_slideshow.html">RISE Slideshow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflows/bids_conversion.html">BIDS conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflows/nipype_full.html">Nipype on Neurodesk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflows/nipype_short.html">Basic Nipype</a></li>

<li class="toctree-l3"><a class="reference internal" href="../workflows/papermill-slurm-submission-example.html">Papermill Slurm Job Submission</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflows/pydra_preproc_ants.html">Pydra</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/intro.html">Tutorials</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/electrophysiology/intro.html">Electrophysiology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/electrophysiology/EEG_mne-python.html">Analysing EEG Data with MNE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/electrophysiology/fieldtrip.html">Analysing M/EEG Data with FieldTrip</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/functional_imaging/intro.html">Functional Imaging</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/functional_imaging/connectomeWorkbench.html">Connectome Workbench</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/functional_imaging/fmriprep.html">Using fmriprep with neurodesk on an HPC</a></li>


<li class="toctree-l3"><a class="reference internal" href="../../tutorials/functional_imaging/mriqc.html">Using mriqc with neurodesk on HPC</a></li>


<li class="toctree-l3"><a class="reference internal" href="../../tutorials/functional_imaging/physio.html">PhysIO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/functional_imaging/physio_batch_workflow.html">A batch scripting example for PhysIO toolbox</a></li>




<li class="toctree-l3"><a class="reference internal" href="../../tutorials/functional_imaging/spm.html">Statistical Parametric Mapping (SPM)</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/multimodal_imaging/intro.html">Multimodal Imaging</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/multimodal_imaging/MFCSC.html">Using MFCSC</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/open_data/intro.html">Open Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/open_data/datalad.html">datalad</a></li>


<li class="toctree-l3"><a class="reference internal" href="../../tutorials/open_data/osfclient.html">osfclient</a></li>



</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/phase_processing/intro.html">Phase Processing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/phase_processing/qsm.html">Quantitative Susceptibility Mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/phase_processing/swi.html">SWI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/phase_processing/unwrapping.html">Unwrapping</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/programming/intro.html">Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/programming/conda.html">Conda environments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/programming/matlab.html">Matlab</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/reproducibility/intro.html">Reproducibility</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/reproducibility/datalad-run.html">Reproducible script execution with DataLad</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/spectroscopy/intro.html">Spectroscopy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/spectroscopy/lcmodel.html">Spectroscopy with lcmodel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/spectroscopy/mrsiproc.html">Spectroscopy pipeline</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/structural_imaging/intro.html">Structural Imaging</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/structural_imaging/freesurfer.html">FreeSurfer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/structural_imaging/structuralconnectivity.html">Structural connectivity dMRI</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../contribute/intro.html">Contribute</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../contribute/examples.html">Contribute Example Notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contribute/tutorials.html">Contribute Tutorials</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/examples/functional_imaging/process_five_echo_dataset.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>tedana: TE Dependent ANAlysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#process-five-echo-flashing-checkerboard-dataset-for-software-demo">Process five-echo flashing checkerboard dataset for software demo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#citation">Citation:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tools-included-in-this-workflow">Tools included in this workflow</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#publications">Publications</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#educational-resources">Educational resources</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset">Dataset</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-5-echo-data">Download 5 echo data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-workflow-on-5-echo-data">Run workflow on 5 echo data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tedana-report-of-5-echo-data">Tedana report of 5 echo data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carpet-plot">Carpet plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adaptive-mask">Adaptive Mask</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t2">T2*</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#s0">S0</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t2-and-s0-model-fit-rmse-scaled-between-2nd-and-98th-percentiles">T2* and S0 model fit (RMSE). (Scaled between 2nd and 98th percentiles)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-generation-using-afni-commands">Time series generation using AFNI commands</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-workflow-on-5-echo-data-using-existing-mixing-matrix-and-external-regressors">Run workflow on 5 echo data using existing mixing matrix and external regressors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#components-of-the-tedana-report-of-5-echo-data-with-external-regressors">Components of the tedana report of 5 echo data with external regressors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Carpet plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Adaptive Mask</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">T2*</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">S0</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">T2* and S0 model fit (RMSE). (Scaled between 2nd and 98th percentiles)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#external-regressors">External regressors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies-in-jupyter-python">Dependencies in Jupyter/Python</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tedana-te-dependent-analysis">
<h1>tedana: TE Dependent ANAlysis<a class="headerlink" href="#tedana-te-dependent-analysis" title="Link to this heading">#</a></h1>
<section id="process-five-echo-flashing-checkerboard-dataset-for-software-demo">
<h2>Process five-echo flashing checkerboard dataset for software demo<a class="headerlink" href="#process-five-echo-flashing-checkerboard-dataset-for-software-demo" title="Link to this heading">#</a></h2>
<p><strong>Author</strong>: Daniel Handwerker &amp; Monika Doerig</p>
<p><strong>Date</strong>: 23 June 2025</p>
<section id="citation">
<h3>Citation:<a class="headerlink" href="#citation" title="Link to this heading">#</a></h3>
<section id="tools-included-in-this-workflow">
<h4>Tools included in this workflow<a class="headerlink" href="#tools-included-in-this-workflow" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>tedana</strong>: The tedana Community, Ahmed, Z., Bandettini, P. A., Bottenhorn, K. L., Caballero-Gaudes, C., Dowdle, L. T., DuPre, E., Gonzalez-Castillo, J., Handwerker, D., Heunis, S., Kundu, P., Laird, A. R., Markello, R., Markiewicz, C. J., Maullin-Sapey, T., Moia, S., Molfese, P., Salo, T., Staden, I., … Whitaker, K. (2025). ME-ICA/tedana: 25.0.1 (25.0.1). Zenodo. <a class="reference external" href="https://doi.org/10.5281/zenodo.15610868">https://doi.org/10.5281/zenodo.15610868</a></p></li>
</ul>
</section>
<section id="publications">
<h4>Publications<a class="headerlink" href="#publications" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>DuPre, E. M., Salo, T., Ahmed, Z., Bandettini, P. A., Bottenhorn, K. L., Caballero-Gaudes, C., Dowdle, L. T., Gonzalez-Castillo, J., Heunis, S., Kundu, P., Laird, A. R., Markello, R., Markiewicz, C. J., Moia, S., Staden, I., Teves, J. B., Uruñuela, E., Vaziri-Pashkam, M., Whitaker, K., &amp; Handwerker, D. A. (2021). <a class="reference external" href="https://joss.theoj.org/papers/10.21105/joss.03669">TE-dependent analysis of multi-echo fMRI with tedana</a>. Journal of Open Source Software, 6(66), 3669. doi:10.21105/joss.03669.</p></li>
<li><p>Kundu, P., Inati, S. J., Evans, J. W., Luh, W. M., &amp; Bandettini, P. A. (2011). <a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S1053811911014303?via%3Dihub">Differentiating BOLD and non-BOLD signals in fMRI time series using multi-echo EPI</a>. NeuroImage, 60, 1759-1770.</p></li>
<li><p>Kundu, P., Brenowitz, N. D., Voon, V., Worbe, Y., Vértes, P. E., Inati, S. J., Saad, Z. S., Bandettini, P. A., &amp; Bullmore, E. T. (2013). <a class="reference external" href="https://www.pnas.org/doi/full/10.1073/pnas.1301725110">Integrated strategy for improving functional connectivity mapping using multiecho fMRI.</a> Proceedings of the National Academy of Sciences, 110, 16187-16192.</p></li>
</ul>
</section>
<section id="educational-resources">
<h4>Educational resources<a class="headerlink" href="#educational-resources" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://tedana.readthedocs.io/en/stable/index.html#">tedana documentation</a></p></li>
</ul>
</section>
<section id="dataset">
<h4>Dataset<a class="headerlink" href="#dataset" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>DuPre, E., Salo, T., Whitaker, K. J., Teves, J., Dowdle, L., Reynolds, R. C., &amp; Handwerker, D. A. (2024, February 21). tedana data. Retrieved from <a class="reference external" href="https://osf.io/bpe8h/">osf.io/bpe8h</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="err">!</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">tedana</span><span class="o">==</span><span class="mf">25.0.1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">module</span>
<span class="k">await</span> <span class="n">module</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;afni/24.3.00&#39;</span><span class="p">)</span>
<span class="k">await</span> <span class="n">module</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;afni/24.3.00&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os.path</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">op</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">glob</span><span class="w"> </span><span class="kn">import</span> <span class="n">glob</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">webbrowser</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">tedana.workflows</span><span class="w"> </span><span class="kn">import</span> <span class="n">tedana_workflow</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="download-5-echo-data">
<h2>Download 5 echo data<a class="headerlink" href="#download-5-echo-data" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">dset_dir5</span> <span class="o">=</span> <span class="s1">&#39;five-echo-dataset/&#39;</span>
<span class="n">wd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">op</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">dset_dir5</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">dset_dir5</span><span class="p">)</span>

<span class="err">!</span><span class="n">curl</span> <span class="o">-</span><span class="n">L</span> <span class="o">-</span><span class="n">o</span> <span class="n">five_echo_NIH</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">osf</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">ea5v3</span><span class="o">/</span><span class="n">download</span>
<span class="err">!</span><span class="n">tar</span> <span class="n">xf</span> <span class="n">five_echo_NIH</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span> <span class="o">-</span><span class="n">C</span> <span class="n">five</span><span class="o">-</span><span class="n">echo</span><span class="o">-</span><span class="n">dataset</span>
<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;five_echo_NIH.tar.xz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   162  100   162    0     0    321      0 --:--:-- --:--:-- --:--:--   321
100   247  100   247    0     0    394      0 --:--:-- --:--:-- --:--:--   394
100   357  100   357    0     0    461      0 --:--:-- --:--:-- --:--:--   461
  0     0    0     0    0     0      0      0 --:--:--  0:00:03 --:--:--     0
100 68.5M  100 68.5M    0     0   9.8M      0  0:00:06  0:00:06 --:--:-- 22.8M
CPU times: user 76 ms, sys: 141 ms, total: 217 ms
Wall time: 10.1 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Clone GitHub repo and copy files</span>
<span class="o">!</span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/ME-ICA/ohbm-2025-multiecho.git<span class="w"> </span>temp_repo
<span class="o">!</span>cp<span class="w"> </span>-r<span class="w"> </span>temp_repo/five-echo-dataset/*<span class="w"> </span>five-echo-dataset/
<span class="o">!</span>rm<span class="w"> </span>-rf<span class="w"> </span>temp_repo
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cloning into &#39;temp_repo&#39;...
remote: Enumerating objects: 156, done.
remote: Counting objects: 100% (156/156), done.
remote: Compressing objects: 100% (124/124), done.
remote: Total 156 (delta 44), reused 141 (delta 32), pack-reused 0 (from 0)
Receiving objects: 100% (156/156), 16.37 MiB | 42.87 MiB/s, done.
Resolving deltas: 100% (44/44), done.
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-workflow-on-5-echo-data">
<h2>Run workflow on 5 echo data<a class="headerlink" href="#run-workflow-on-5-echo-data" title="Link to this heading">#</a></h2>
<div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">dset_dir5_out</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset_dir5</span><span class="si">}</span><span class="s2">tedana_processed&quot;</span>
<span class="n">files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dset_dir5</span><span class="p">,</span> <span class="s1">&#39;p06*.nii.gz&#39;</span><span class="p">)))</span>
<span class="n">tes</span> <span class="o">=</span> <span class="p">[</span><span class="mf">15.4</span><span class="p">,</span> <span class="mf">29.7</span><span class="p">,</span> <span class="mf">44.0</span><span class="p">,</span> <span class="mf">58.3</span><span class="p">,</span> <span class="mf">72.6</span><span class="p">]</span>
<span class="n">tedana_workflow</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">tes</span><span class="p">,</span> 
    <span class="n">tree</span><span class="o">=</span><span class="s2">&quot;minimal&quot;</span><span class="p">,</span>
    <span class="n">fixed_seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">ica_method</span><span class="o">=</span><span class="s2">&quot;robustica&quot;</span><span class="p">,</span>
    <span class="n">n_robust_runs</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="n">tedpca</span><span class="o">=</span><span class="mi">53</span><span class="p">,</span>
    <span class="n">out_dir</span><span class="o">=</span><span class="n">dset_dir5_out</span><span class="p">,</span>
    <span class="n">tedort</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Setting clustering defaults: {&#39;min_samples&#39;: 15}
Running FastICA multiple times...
Inferring sign of components...
Clustering...
Computing centroids...
Computing Silhouettes...
Computing Iq...
CPU times: user 1h 35min 19s, sys: 16.5 s, total: 1h 35min 35s
Wall time: 4min 56s
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO     tedana:tedana_workflow:608 Using output directory: /home/jovyan/Git_repositories/example-notebooks/books/functional_imaging/five-echo-dataset/tedana_processed
INFO     tedana:tedana_workflow:627 Initializing and validating component selection tree
WARNING  component_selector:validate_tree:146 Decision tree includes fields that are not used or logged [&#39;_comment&#39;]
INFO     component_selector:__init__:333 Performing component selection with minimal_decision_tree
INFO     component_selector:__init__:334 first version of minimal decision tree
INFO     tedana:tedana_workflow:630 Loading input data: [&#39;five-echo-dataset/p06.SBJ01_S09_Task11_e1.sm.nii.gz&#39;, &#39;five-echo-dataset/p06.SBJ01_S09_Task11_e2.sm.nii.gz&#39;, &#39;five-echo-dataset/p06.SBJ01_S09_Task11_e3.sm.nii.gz&#39;, &#39;five-echo-dataset/p06.SBJ01_S09_Task11_e4.sm.nii.gz&#39;, &#39;five-echo-dataset/p06.SBJ01_S09_Task11_e5.sm.nii.gz&#39;]
INFO     io:__init__:156 Generating figures directory: /home/jovyan/Git_repositories/example-notebooks/books/functional_imaging/five-echo-dataset/tedana_processed/figures
WARNING  tedana:tedana_workflow:735 Computing EPI mask from first echo using nilearn&#39;s compute_epi_mask function. Most external pipelines include more reliable masking functions. It is strongly recommended to provide an external mask, and to visually confirm that mask accurately conforms to data boundaries.
INFO     utils:make_adaptive_mask:202 Echo-wise intensity thresholds for adaptive mask: [5853.6399821  4862.62750244 4073.26911418 3377.14188232 2800.73880819]
WARNING  utils:make_adaptive_mask:231 4 voxels in user-defined mask do not have good signal. Removing voxels from mask.
INFO     tedana:tedana_workflow:774 Computing T2* map
/opt/conda/lib/python3.11/site-packages/tedana/decay.py:541: RuntimeWarning: Mean of empty slice
  rmse_map = np.nanmean(rmse, axis=1)
INFO     combine:make_optcom:192 Optimally combining data with voxel-wise T2* estimates
INFO     tedana:tedana_workflow:822 Writing optimally combined data set: /home/jovyan/Git_repositories/example-notebooks/books/functional_imaging/five-echo-dataset/tedana_processed/desc-optcom_bold.nii.gz
INFO     pca:tedpca:208 Computing PCA of optimally combined multi-echo data with selection criteria: 53
INFO     collect:generate_metrics:161 Calculating weight maps
INFO     collect:generate_metrics:173 Calculating parameter estimate maps for optimally combined data
INFO     collect:generate_metrics:193 Calculating z-statistic maps
INFO     collect:generate_metrics:203 Calculating F-statistic maps
INFO     collect:generate_metrics:228 Thresholding z-statistic maps
INFO     collect:generate_metrics:238 Calculating T2* F-statistic maps
INFO     collect:generate_metrics:248 Calculating S0 F-statistic maps
INFO     collect:generate_metrics:259 Counting significant voxels in T2* F-statistic maps
INFO     collect:generate_metrics:265 Counting significant voxels in S0 F-statistic maps
INFO     collect:generate_metrics:272 Thresholding optimal combination beta maps to match T2* F-statistic maps
INFO     collect:generate_metrics:281 Thresholding optimal combination beta maps to match S0 F-statistic maps
INFO     collect:generate_metrics:291 Calculating kappa and rho
INFO     collect:generate_metrics:300 Calculating variance explained
INFO     collect:generate_metrics:306 Calculating normalized variance explained
INFO     collect:generate_metrics:313 Calculating DSI between thresholded T2* F-statistic and optimal combination beta maps
INFO     collect:generate_metrics:323 Calculating DSI between thresholded S0 F-statistic and optimal combination beta maps
INFO     collect:generate_metrics:334 Calculating signal-noise t-statistics
INFO     collect:generate_metrics:368 Counting significant noise voxels from z-statistic maps
INFO     collect:generate_metrics:380 Calculating decision table score
INFO     pca:tedpca:412 Selected 53 components with 88.73% normalized variance explained using a fixed number of components and no dimensionality estimate
/opt/conda/lib/python3.11/site-packages/tedana/io.py:355: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option(&#39;future.no_silent_downcasting&#39;, True)`
  deblanked = data.replace(&quot;&quot;, np.nan)
100%|██████████| 30/30 [02:41&lt;00:00,  5.37s/it]
INFO     ica:r_ica:204 For RobustICA, FastICA did not converge in 3 of 30 interations.
INFO     ica:r_ica:225 The DBSCAN clustering algorithm was used for clustering components across different runs
INFO     ica:r_ica:243 RobustICA with 30 robust runs and seed 42 was used. 39 components identified. The mean Index Quality is 0.9487658376877335.
INFO     ica:r_ica:251 The DBSCAN clustering algorithm detected outliers when clustering components for different runs. These outliers are excluded when calculating the index quality and the mixing matrix to maximise the robustness of the decomposition.
/opt/conda/lib/python3.11/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: &#39;n_iter&#39; was renamed to &#39;max_iter&#39; in version 1.5 and will be removed in 1.7.
  warnings.warn(
INFO     collect:generate_metrics:161 Calculating weight maps
INFO     collect:generate_metrics:173 Calculating parameter estimate maps for optimally combined data
INFO     collect:generate_metrics:193 Calculating z-statistic maps
INFO     collect:generate_metrics:203 Calculating F-statistic maps
INFO     collect:generate_metrics:228 Thresholding z-statistic maps
INFO     collect:generate_metrics:238 Calculating T2* F-statistic maps
INFO     collect:generate_metrics:248 Calculating S0 F-statistic maps
INFO     collect:generate_metrics:259 Counting significant voxels in T2* F-statistic maps
INFO     collect:generate_metrics:265 Counting significant voxels in S0 F-statistic maps
INFO     collect:generate_metrics:272 Thresholding optimal combination beta maps to match T2* F-statistic maps
INFO     collect:generate_metrics:281 Thresholding optimal combination beta maps to match S0 F-statistic maps
INFO     collect:generate_metrics:291 Calculating kappa and rho
INFO     collect:generate_metrics:300 Calculating variance explained
INFO     collect:generate_metrics:306 Calculating normalized variance explained
INFO     collect:generate_metrics:313 Calculating DSI between thresholded T2* F-statistic and optimal combination beta maps
INFO     collect:generate_metrics:323 Calculating DSI between thresholded S0 F-statistic and optimal combination beta maps
INFO     collect:generate_metrics:334 Calculating signal-noise t-statistics
INFO     tedana:tedana_workflow:894 Selecting components from ICA results
INFO     tedica:automatic_selection:54 Performing ICA component selection with tree: minimal
INFO     selection_nodes:manual_classify:104 Step 0: manual_classify: Set all to unclassified 
INFO     selection_utils:comptable_classification_changer:293 Step 0: No components fit criterion False to change classification
INFO     selection_utils:log_decision_tree_step:447 Step 0: manual_classify applied to 39 components. 39 True -&gt; unclassified. 0 False -&gt; nochange.
INFO     selection_nodes:manual_classify:136 Step 0: manual_classify component classification tags are cleared
INFO     selection_utils:log_classification_counts:492 Step 0: Total component classifications: 39 unclassified
INFO     selection_nodes:dec_left_op_right:389 Step 1: left_op_right: rejected if rho&gt;kappa, else nochange
INFO     selection_utils:log_decision_tree_step:447 Step 1: left_op_right applied to 39 components. 5 True -&gt; rejected. 34 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 1: Total component classifications: 5 rejected, 34 unclassified
INFO     selection_nodes:dec_left_op_right:389 Step 2: left_op_right: rejected if [&#39;countsigFS0&gt;countsigFT2 &amp; countsigFT2&gt;0&#39;], else nochange
INFO     selection_utils:log_decision_tree_step:447 Step 2: left_op_right applied to 39 components. 2 True -&gt; rejected. 37 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 2: Total component classifications: 5 rejected, 34 unclassified
INFO     selection_nodes:calc_median:653 Step 3: calc_median: Median(median_varex)
INFO     selection_utils:log_decision_tree_step:459 Step 3: calc_median calculated: median_varex=0.5929824670451252
INFO     selection_utils:log_classification_counts:492 Step 3: Total component classifications: 5 rejected, 34 unclassified
INFO     selection_nodes:dec_left_op_right:389 Step 4: left_op_right: rejected if [&#39;dice_FS0&gt;dice_FT2 &amp; variance explained&gt;0.59&#39;], else nochange
INFO     selection_utils:comptable_classification_changer:293 Step 4: No components fit criterion True to change classification
INFO     selection_utils:log_decision_tree_step:447 Step 4: left_op_right applied to 39 components. 0 True -&gt; rejected. 39 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 4: Total component classifications: 5 rejected, 34 unclassified
INFO     selection_nodes:dec_left_op_right:389 Step 5: left_op_right: rejected if [&#39;0&gt;signal-noise_t &amp; variance explained&gt;0.59&#39;], else nochange
INFO     selection_utils:log_decision_tree_step:447 Step 5: left_op_right applied to 39 components. 4 True -&gt; rejected. 35 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 5: Total component classifications: 7 rejected, 32 unclassified
INFO     selection_nodes:calc_kappa_elbow:767 Step 6: calc_kappa_elbow: Calc Kappa Elbow
INFO     selection_utils:kappa_elbow_kundu:668 Calculating kappa elbow based on all components.
INFO     selection_utils:log_decision_tree_step:459 Step 6: calc_kappa_elbow calculated: kappa_elbow_kundu=72.03387706853437, kappa_allcomps_elbow=72.03387706853437, kappa_nonsig_elbow=None, varex_upper_p=0.701960220936485
INFO     selection_utils:log_classification_counts:492 Step 6: Total component classifications: 7 rejected, 32 unclassified
INFO     selection_nodes:calc_rho_elbow:902 Step 7: calc_rho_elbow: Calc Rho Elbow
INFO     selection_utils:log_decision_tree_step:459 Step 7: calc_rho_elbow calculated: rho_elbow_liberal=20.056182881485636, rho_allcomps_elbow=20.056182881485636, rho_unclassified_elbow=19.718998357040384, elbow_f05=7.708647422176786
INFO     selection_utils:log_classification_counts:492 Step 7: Total component classifications: 7 rejected, 32 unclassified
INFO     selection_nodes:dec_left_op_right:389 Step 8: left_op_right: provisionalaccept if kappa&gt;=72.03, else provisionalreject
INFO     selection_utils:log_decision_tree_step:447 Step 8: left_op_right applied to 32 components. 13 True -&gt; provisionalaccept. 19 False -&gt; provisionalreject.
INFO     selection_utils:log_classification_counts:492 Step 8: Total component classifications: 13 provisionalaccept, 19 provisionalreject, 7 rejected
INFO     selection_nodes:dec_left_op_right:389 Step 9: left_op_right: accepted if kappa&gt;2*rho, else nochange
INFO     selection_utils:comptable_classification_changer:293 Step 9: No components fit criterion False to change classification
INFO     selection_utils:log_decision_tree_step:447 Step 9: left_op_right applied to 13 components. 13 True -&gt; accepted. 0 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 9: Total component classifications: 13 accepted, 19 provisionalreject, 7 rejected
INFO     selection_nodes:dec_left_op_right:389 Step 10: left_op_right: provisionalreject if rho&gt;20.06, else nochange
INFO     selection_utils:log_decision_tree_step:447 Step 10: left_op_right applied to 19 components. 3 True -&gt; provisionalreject. 16 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 10: Total component classifications: 13 accepted, 19 provisionalreject, 7 rejected
INFO     selection_nodes:dec_variance_lessthan_thresholds:533 Step 11: variance_lt_thresholds: accepted if variance explained&lt;0.1. All variance&lt;1.0, else nochange
INFO     selection_utils:comptable_classification_changer:293 Step 11: No components fit criterion True to change classification
INFO     selection_utils:log_decision_tree_step:447 Step 11: variance_lt_thresholds applied to 19 components. 0 True -&gt; accepted. 19 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 11: Total component classifications: 13 accepted, 19 provisionalreject, 7 rejected
INFO     selection_nodes:manual_classify:104 Step 12: manual_classify: Set provisionalaccept to accepted 
INFO     selection_utils:log_decision_tree_step:441 Step 12: manual_classify not applied because no remaining components were classified as provisionalaccept
INFO     selection_utils:log_classification_counts:492 Step 12: Total component classifications: 13 accepted, 19 provisionalreject, 7 rejected
INFO     selection_nodes:manual_classify:104 Step 13: manual_classify: Set [&#39;provisionalreject&#39;, &#39;unclassified&#39;] to rejected 
INFO     selection_utils:comptable_classification_changer:293 Step 13: No components fit criterion False to change classification
INFO     selection_utils:log_decision_tree_step:447 Step 13: manual_classify applied to 19 components. 19 True -&gt; rejected. 0 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 13: Total component classifications: 13 accepted, 26 rejected
INFO     io:denoise_ts:613 Variance explained by decomposition: 94.68%
INFO     io:write_split_ts:700 Writing denoised time series: /home/jovyan/Git_repositories/example-notebooks/books/functional_imaging/five-echo-dataset/tedana_processed/desc-denoised_bold.nii.gz
INFO     io:writeresults:749 Writing full ICA coefficient feature set: /home/jovyan/Git_repositories/example-notebooks/books/functional_imaging/five-echo-dataset/tedana_processed/desc-ICA_components.nii.gz
INFO     io:writeresults:753 Writing denoised ICA coefficient feature set: /home/jovyan/Git_repositories/example-notebooks/books/functional_imaging/five-echo-dataset/tedana_processed/desc-ICAAccepted_components.nii.gz
INFO     io:writeresults:759 Writing Z-normalized spatial component maps: /home/jovyan/Git_repositories/example-notebooks/books/functional_imaging/five-echo-dataset/tedana_processed/desc-ICAAccepted_stat-z_components.nii.gz
INFO     tedana:tedana_workflow:1116 Making figures folder with static component maps and timecourse plots.
INFO     io:denoise_ts:613 Variance explained by decomposition: 94.68%
/opt/conda/lib/python3.11/site-packages/tedana/io.py:904: UserWarning: Data array used to create a new image contains 64-bit ints. This is likely due to creating the array with numpy and passing `int` as the `dtype`. Many tools such as FSL and SPM cannot deal with int64 in Nifti images, so for compatibility the data has been converted to int32.
  nii = new_img_like(ref_img, newdata, affine=affine, copy_header=copy_header)
/opt/conda/lib/python3.11/site-packages/tedana/io.py:904: UserWarning: Data array used to create a new image contains 64-bit ints. This is likely due to creating the array with numpy and passing `int` as the `dtype`. Many tools such as FSL and SPM cannot deal with int64 in Nifti images, so for compatibility the data has been converted to int32.
  nii = new_img_like(ref_img, newdata, affine=affine, copy_header=copy_header)
/opt/conda/lib/python3.11/site-packages/tedana/io.py:904: UserWarning: Data array used to create a new image contains 64-bit ints. This is likely due to creating the array with numpy and passing `int` as the `dtype`. Many tools such as FSL and SPM cannot deal with int64 in Nifti images, so for compatibility the data has been converted to int32.
  nii = new_img_like(ref_img, newdata, affine=affine, copy_header=copy_header)
/opt/conda/lib/python3.11/site-packages/nilearn/plotting/img_plotting.py:1416: UserWarning: Non-finite values detected. These values will be replaced with zeros.
  safe_get_data(stat_map_img, ensure_finite=True),
INFO     tedana:tedana_workflow:1172 Generating dynamic report
INFO     html_report:_update_template_bokeh:164 Checking for adaptive mask: adaptive_mask.svg, exists: True
INFO     html_report:_update_template_bokeh:204 T2* files exist: True
INFO     html_report:_update_template_bokeh:205 S0 files exist: True
INFO     html_report:_update_template_bokeh:206 RMSE files exist: True
INFO     html_report:_update_template_bokeh:212 External regressors exist: False
INFO     tedana:tedana_workflow:1175 Workflow completed
INFO     utils:log_newsletter_info:705 Don&#39;t forget to subscribe to the tedana newsletter for updates! This is a very low volume email list.
INFO     utils:log_newsletter_info:709 https://groups.google.com/g/tedana-newsletter
</pre></div>
</div>
</div>
</div>
</section>
<section id="tedana-report-of-5-echo-data">
<h2>Tedana report of 5 echo data<a class="headerlink" href="#tedana-report-of-5-echo-data" title="Link to this heading">#</a></h2>
<p>You can explore an example of an interactive tedana report <a class="reference external" href="https://me-ica.github.io/ohbm-2023-multiecho/tedana/tedana_results_minimal_five-echo/tedana_report.html">here</a>.</p>
<p>The tedana report for the current dataset was generated at the following location:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this is the path of the tedana report</span>
<span class="n">url</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">dset_dir5_out</span> <span class="o">+</span> <span class="s1">&#39;/tedana_report.html&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/jovyan/Git_repositories/example-notebooks/books/functional_imaging/five-echo-dataset/tedana_processed/tedana_report.html
</pre></div>
</div>
</div>
</div>
<p>To properly view the interactive <em>tedana html report</em> with all figures displayed correctly, right-click the file at the path shown above and select <strong>Open in New Browser Tab</strong>.</p>
<p>Below, selected components from the generated tedana report are visualized.</p>
<section id="carpet-plot">
<h3>Carpet plot<a class="headerlink" href="#carpet-plot" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.core.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">SVG</span>

<span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;five-echo-dataset/tedana_processed/figures/carpet_optcom.svg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/658d46c99590a89d1fa2e8a598ee71be334c39c302a2d6d28392a2e76f5127fb.svg" src="../../_images/658d46c99590a89d1fa2e8a598ee71be334c39c302a2d6d28392a2e76f5127fb.svg" />
</div>
</div>
</section>
<section id="adaptive-mask">
<h3>Adaptive Mask<a class="headerlink" href="#adaptive-mask" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;five-echo-dataset/tedana_processed/figures/adaptive_mask.svg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e8488c0b88097e040f0962164eb8e0cdced4796c5e9c5dbf4066a25c32e35044.svg" src="../../_images/e8488c0b88097e040f0962164eb8e0cdced4796c5e9c5dbf4066a25c32e35044.svg" />
</div>
</div>
</section>
<section id="t2">
<h3>T2*<a class="headerlink" href="#t2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2star_brain</span> <span class="o">=</span> <span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;five-echo-dataset/tedana_processed/figures/t2star_brain.svg&#39;</span><span class="p">)</span>
<span class="n">t2star_histogram</span> <span class="o">=</span> <span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;five-echo-dataset/tedana_processed/figures/t2star_histogram.svg&#39;</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">t2star_brain</span><span class="p">,</span> <span class="n">t2star_histogram</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2cd88c94848ce1b425a61087135d88c9a26e650b6f4dfa5d493a9be1454bcd97.svg" src="../../_images/2cd88c94848ce1b425a61087135d88c9a26e650b6f4dfa5d493a9be1454bcd97.svg" />
<img alt="../../_images/90fcdadd90aeda6b985b3392cecb32c53389587dc8c0f7047b9656dcae8af747.svg" src="../../_images/90fcdadd90aeda6b985b3392cecb32c53389587dc8c0f7047b9656dcae8af747.svg" />
</div>
</div>
</section>
<section id="s0">
<h3>S0<a class="headerlink" href="#s0" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s0_brain</span> <span class="o">=</span> <span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;five-echo-dataset/tedana_processed/figures/s0_brain.svg&#39;</span><span class="p">)</span>
<span class="n">s0_histogram</span> <span class="o">=</span> <span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;five-echo-dataset/tedana_processed/figures/s0_histogram.svg&#39;</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">s0_brain</span><span class="p">,</span> <span class="n">s0_histogram</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/dbbb0e73861c3c3b540760e614f6f738c60fc47be2469e886791ab48f4e16105.svg" src="../../_images/dbbb0e73861c3c3b540760e614f6f738c60fc47be2469e886791ab48f4e16105.svg" />
<img alt="../../_images/93f08e84d31c0bbccf11580578660daf6b9d9eabdedec0cf663afaf25f2432d3.svg" src="../../_images/93f08e84d31c0bbccf11580578660daf6b9d9eabdedec0cf663afaf25f2432d3.svg" />
</div>
</div>
</section>
<section id="t2-and-s0-model-fit-rmse-scaled-between-2nd-and-98th-percentiles">
<h3>T2* and S0 model fit (RMSE). (Scaled between 2nd and 98th percentiles)<a class="headerlink" href="#t2-and-s0-model-fit-rmse-scaled-between-2nd-and-98th-percentiles" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rmse_brain</span> <span class="o">=</span> <span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;five-echo-dataset/tedana_processed/figures/rmse_brain.svg&#39;</span><span class="p">)</span>
<span class="n">rmse_timeseries</span> <span class="o">=</span> <span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;five-echo-dataset/tedana_processed/figures/rmse_timeseries.svg&#39;</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">rmse_brain</span><span class="p">,</span> <span class="n">rmse_timeseries</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/982dc674628574173176416ddc4e384b374d51833ab5042836ef173b2da10e36.svg" src="../../_images/982dc674628574173176416ddc4e384b374d51833ab5042836ef173b2da10e36.svg" />
<img alt="../../_images/abf1bc45fff65424a698bdef37357f2af4c95d72c561555f36d16e8671edc209.svg" src="../../_images/abf1bc45fff65424a698bdef37357f2af4c95d72c561555f36d16e8671edc209.svg" />
</div>
</div>
</section>
<section id="time-series-generation-using-afni-commands">
<h3>Time series generation using AFNI commands<a class="headerlink" href="#time-series-generation-using-afni-commands" title="Link to this heading">#</a></h3>
<div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
# A rough CSF mask for demonstration purposes
# Segment the CSF, erode by 1 voxel, #
# and retain voxels containing 75% of the CSF mask when downsampled to EPI space
cd five-echo-dataset

3dSeg -anat SBJ01_Anatomy.nii.gz -mask AUTO \
    -classes &#39;CSF ; GM ; WM&#39;  \
    -bias_classes &#39;GM ; WM&#39; \
    -bias_fwhm 25 -mixfrac UNI -main_N 5 \
    -blur_meth BFT
3dcalc -a ./Segsy/Classes+tlrc -expr &#39;equals(a, 1)&#39; -prefix CSF_anatresolution.nii.gz
3dmask_tool -input CSF_anatresolution.nii.gz \
    -prefix CSF_eroded.nii.gz \
    -dilate_result -1 -fill_holes 
3dfractionize -template p06.SBJ01_S09_Task11_e3.sm.nii.gz \
    -prefix CSF_mask.nii.gz \
    -input CSF_eroded.nii.gz \
    -clip 0.75

# make CSF principal components
3dpc -mask CSF_mask.nii.gz -pcsave 3  \
    -prefix CSF_timeseries \
    ./tedana_processed/desc-optcom_bold.nii.gz

# Combine all external regressors into a single file
external_regress_header=&quot;mot_x\tmot_y\tmot_z\tmot_pitch\tmot_roll\tmot_yaw\t&quot;\
&quot;mot_dx\tmot_dy\tmot_dz\tmot_dpitch\tmot_droll\tmot_dyaw\tcsf1\tcsf2\tcsf3\t&quot;\
&quot;signal_checkerboard&quot;

1dcat -tsvout \
    SBJ01_S09_Task11_e2_Motion.demean.1D \
    SBJ01_S09_Task11_e2_Motion.demean.der.1D \
    CSF_timeseries0?.1D \
    block_task_response.1D \
    &gt; tmp.tsv

# Convert spaces to tabs and skip the header line from 1dcat
tail -n +2 tmp.tsv | tr &#39; &#39; &#39;\t&#39; &gt; tmp_clean.tsv

# Add header
(echo -e &quot;$external_regress_header&quot;; cat tmp_clean.tsv) &gt; external_regressors.tsv

# Clean up
rm tmp.tsv tmp_clean.tsv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>++ Compile date = Oct  1 2024 {AFNI_24.3.00:linux_ubuntu_24_64}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>*+ WARNING: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
*+ WARNING: ss.cp+tlrc[0] scale to shorts mean misfit error = 38.4% -- **** Red Alert ****
 + a) Numerical precision has been lost when truncating results
       from 32-bit floating point to 16-bit integers (shorts).
 + b) Consider writing datasets out in float format.
       In most AFNI programs, use the &#39;-float&#39; option.
 + c) This warning is a new message, but is an old issue
       that arises when storing results in an integer format.
 + d) Don&#39;t panic! These messages likely originate in peripheral
       or unimportant voxels. They mean that you must examine your output.
       &quot;Assess the situation and keep a calm head about you,
        because it doesn&#39;t do anybody any good to panic.&quot;
++ ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
*+ WARNING: GenPriorsOut.x+tlrc[0] scale to shorts mean misfit error = 40.0% -- ***** Purple Alert! *****
*+ WARNING: GenPriorsOut.x+tlrc[0] scale to shorts mean misfit error = 39.8% -- ***** Purple Alert! *****
*+ WARNING: GenPriorsOut.x+tlrc[0] scale to shorts mean misfit error = 39.3% -- ***** Purple Alert! *****
*+ WARNING: GenPriorsOut.x+tlrc[0] scale to shorts mean misfit error = 38.9% -- **** Red Alert ****
*+ WARNING: GenPriorsOut.x+tlrc[0] scale to shorts mean misfit error = 38.4% -- **** Red Alert ****
++ 3dcalc: AFNI version=AFNI_24.3.00 (Oct  1 2024) [64-bit]
++ Authored by: A cast of thousands
++ Output dataset ./CSF_anatresolution.nii.gz
++ no -frac option: defaulting to -union
++ processing 1 input dataset(s), NN=2...
++ padding all datasets by 0 (for dilations)
++ have 1 volumes of input to combine
++ frac 0 over 1 volumes gives min count 0
++ voxel limits: 0 clipped, 135363 survived, 11398973 were zero
++ filled 0 holes (0 voxels)
++ writing result CSF_eroded.nii.gz...
++ Output dataset ./CSF_eroded.nii.gz
++ 3dfractionize: AFNI version=AFNI_24.3.00 (Oct  1 2024) [64-bit]
++ Authored by: RW Cox
-- Writing 83 nonzero mask voxels to dataset ./CSF_mask.nii.gz
++ 3dpc: AFNI version=AFNI_24.3.00 (Oct  1 2024) [64-bit]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="run-workflow-on-5-echo-data-using-existing-mixing-matrix-and-external-regressors">
<h2>Run workflow on 5 echo data using existing mixing matrix and external regressors<a class="headerlink" href="#run-workflow-on-5-echo-data-using-existing-mixing-matrix-and-external-regressors" title="Link to this heading">#</a></h2>
<div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">dset_dir5_extern_out</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset_dir5</span><span class="si">}</span><span class="s2">tedana_external_regress_processed&quot;</span>
<span class="n">files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dset_dir5</span><span class="p">,</span> <span class="s1">&#39;p06*.nii.gz&#39;</span><span class="p">)))</span>
<span class="n">tes</span> <span class="o">=</span> <span class="p">[</span><span class="mf">15.4</span><span class="p">,</span> <span class="mf">29.7</span><span class="p">,</span> <span class="mf">44.0</span><span class="p">,</span> <span class="mf">58.3</span><span class="p">,</span> <span class="mf">72.6</span><span class="p">]</span>
<span class="n">tedana_workflow</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">tes</span><span class="p">,</span> 
    <span class="n">tree</span><span class="o">=</span><span class="s2">&quot;demo_external_regressors_motion_task_models&quot;</span><span class="p">,</span>
    <span class="n">external_regressors</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dset_dir5</span><span class="p">,</span><span class="s2">&quot;external_regressors.tsv&quot;</span><span class="p">),</span>
    <span class="n">mixing_file</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dset_dir5</span><span class="p">,</span><span class="s2">&quot;tedana_processed&quot;</span><span class="p">,</span> <span class="s2">&quot;desc-ICA_mixing.tsv&quot;</span><span class="p">),</span>
    <span class="n">out_dir</span><span class="o">=</span><span class="n">dset_dir5_extern_out</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(160, 39)
(160, 39)
(160, 39)
(160, 39)
CPU times: user 6min 41s, sys: 4.22 s, total: 6min 45s
Wall time: 1min 52s
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO     tedana:tedana_workflow:608 Using output directory: /home/jovyan/Git_repositories/example-notebooks/books/functional_imaging/five-echo-dataset/tedana_external_regress_processed
INFO     tedana:tedana_workflow:627 Initializing and validating component selection tree
INFO     component_selector:__init__:333 Performing component selection with demo_external_regressors_motion_task_models
INFO     component_selector:__init__:334 Demonstration based on the minimal decision tree that uses partial F stats on a model with multiple external regressors divided by category and task regressors to bias towards keeping.
INFO     tedana:tedana_workflow:630 Loading input data: [&#39;five-echo-dataset/p06.SBJ01_S09_Task11_e1.sm.nii.gz&#39;, &#39;five-echo-dataset/p06.SBJ01_S09_Task11_e2.sm.nii.gz&#39;, &#39;five-echo-dataset/p06.SBJ01_S09_Task11_e3.sm.nii.gz&#39;, &#39;five-echo-dataset/p06.SBJ01_S09_Task11_e4.sm.nii.gz&#39;, &#39;five-echo-dataset/p06.SBJ01_S09_Task11_e5.sm.nii.gz&#39;]
INFO     io:__init__:156 Generating figures directory: /home/jovyan/Git_repositories/example-notebooks/books/functional_imaging/five-echo-dataset/tedana_external_regress_processed/figures
WARNING  tedana:tedana_workflow:735 Computing EPI mask from first echo using nilearn&#39;s compute_epi_mask function. Most external pipelines include more reliable masking functions. It is strongly recommended to provide an external mask, and to visually confirm that mask accurately conforms to data boundaries.
INFO     utils:make_adaptive_mask:202 Echo-wise intensity thresholds for adaptive mask: [5853.6399821  4862.62750244 4073.26911418 3377.14188232 2800.73880819]
WARNING  utils:make_adaptive_mask:231 4 voxels in user-defined mask do not have good signal. Removing voxels from mask.
INFO     tedana:tedana_workflow:774 Computing T2* map
/opt/conda/lib/python3.11/site-packages/tedana/decay.py:541: RuntimeWarning: Mean of empty slice
  rmse_map = np.nanmean(rmse, axis=1)
INFO     combine:make_optcom:192 Optimally combining data with voxel-wise T2* estimates
INFO     tedana:tedana_workflow:822 Writing optimally combined data set: /home/jovyan/Git_repositories/example-notebooks/books/functional_imaging/five-echo-dataset/tedana_external_regress_processed/desc-optcom_bold.nii.gz
INFO     tedana:tedana_workflow:931 Using supplied mixing matrix from ICA
INFO     collect:generate_metrics:161 Calculating weight maps
INFO     collect:generate_metrics:173 Calculating parameter estimate maps for optimally combined data
INFO     collect:generate_metrics:193 Calculating z-statistic maps
INFO     collect:generate_metrics:203 Calculating F-statistic maps
INFO     collect:generate_metrics:228 Thresholding z-statistic maps
INFO     collect:generate_metrics:238 Calculating T2* F-statistic maps
INFO     collect:generate_metrics:248 Calculating S0 F-statistic maps
INFO     collect:generate_metrics:259 Counting significant voxels in T2* F-statistic maps
INFO     collect:generate_metrics:265 Counting significant voxels in S0 F-statistic maps
INFO     collect:generate_metrics:272 Thresholding optimal combination beta maps to match T2* F-statistic maps
INFO     collect:generate_metrics:281 Thresholding optimal combination beta maps to match S0 F-statistic maps
INFO     collect:generate_metrics:291 Calculating kappa and rho
INFO     collect:generate_metrics:300 Calculating variance explained
INFO     collect:generate_metrics:306 Calculating normalized variance explained
INFO     collect:generate_metrics:313 Calculating DSI between thresholded T2* F-statistic and optimal combination beta maps
INFO     collect:generate_metrics:323 Calculating DSI between thresholded S0 F-statistic and optimal combination beta maps
INFO     collect:generate_metrics:334 Calculating signal-noise t-statistics
INFO     collect:generate_metrics:393 Calculating external regressor fits. Fits all external nuisance regressors to a single model using an F statistic
INFO     collect:generate_metrics:393 Calculating external regressor fits. Fits all task regressors to a single model using an F statistic
INFO     external:fit_regressors:286 External regressors fit for nuisance includes detrending with 2 Legendre Polynomial regressors.
INFO     external:fit_mixing_to_regressors:380 Running fit_mixing_to_regressors for nuisance
INFO     external:fit_mixing_to_regressors:381 ICA matrix has 160 time points and 39 components
INFO     external:build_fstat_regressor_models:473 Size for base regressor model for nuisance: (160, 2)
INFO     external:build_fstat_regressor_models:488 Size for full regressor model for nuisance: (160, 17)
INFO     external:build_fstat_regressor_models:489 Regressors in full model for nuisance: [&#39;baseline 0&#39;, &#39;baseline 1&#39;, &#39;csf1&#39;, &#39;csf2&#39;, &#39;csf3&#39;, &#39;mot_dpitch&#39;, &#39;mot_droll&#39;, &#39;mot_dx&#39;, &#39;mot_dy&#39;, &#39;mot_dyaw&#39;, &#39;mot_dz&#39;, &#39;mot_pitch&#39;, &#39;mot_roll&#39;, &#39;mot_x&#39;, &#39;mot_y&#39;, &#39;mot_yaw&#39;, &#39;mot_z&#39;]
INFO     external:build_fstat_regressor_models:511 Size of external regressor partial model &#39;no Motion&#39;: (160, 5)
INFO     external:build_fstat_regressor_models:515 Regressors in partial model (everything but regressors of interest) &#39;no Motion&#39;: [&#39;baseline 0&#39;, &#39;baseline 1&#39;, &#39;csf1&#39;, &#39;csf2&#39;, &#39;csf3&#39;]
INFO     external:build_fstat_regressor_models:511 Size of external regressor partial model &#39;no CSF&#39;: (160, 14)
INFO     external:build_fstat_regressor_models:515 Regressors in partial model (everything but regressors of interest) &#39;no CSF&#39;: [&#39;baseline 0&#39;, &#39;baseline 1&#39;, &#39;mot_dpitch&#39;, &#39;mot_droll&#39;, &#39;mot_dx&#39;, &#39;mot_dy&#39;, &#39;mot_dyaw&#39;, &#39;mot_dz&#39;, &#39;mot_pitch&#39;, &#39;mot_roll&#39;, &#39;mot_x&#39;, &#39;mot_y&#39;, &#39;mot_yaw&#39;, &#39;mot_z&#39;]
INFO     external:fit_regressors:286 External regressors fit for task includes detrending with 2 Legendre Polynomial regressors.
INFO     external:fit_mixing_to_regressors:380 Running fit_mixing_to_regressors for task
INFO     external:fit_mixing_to_regressors:381 ICA matrix has 160 time points and 39 components
INFO     external:build_fstat_regressor_models:473 Size for base regressor model for task: (160, 2)
INFO     external:build_fstat_regressor_models:488 Size for full regressor model for task: (160, 3)
INFO     external:build_fstat_regressor_models:489 Regressors in full model for task: [&#39;baseline 0&#39;, &#39;baseline 1&#39;, &#39;signal_checkerboard&#39;]
INFO     tedica:automatic_selection:54 Performing ICA component selection with tree: demo_external_regressors_motion_task_models
INFO     selection_nodes:manual_classify:104 Step 0: manual_classify: Set all to unclassified 
INFO     selection_utils:comptable_classification_changer:293 Step 0: No components fit criterion False to change classification
INFO     selection_utils:log_decision_tree_step:447 Step 0: manual_classify applied to 39 components. 39 True -&gt; unclassified. 0 False -&gt; nochange.
INFO     selection_nodes:manual_classify:136 Step 0: manual_classify component classification tags are cleared
INFO     selection_utils:log_classification_counts:492 Step 0: Total component classifications: 39 unclassified
INFO     selection_nodes:dec_left_op_right:389 Step 1: left_op_right: provisionalreject if rho&gt;kappa, else nochange
INFO     selection_utils:log_decision_tree_step:447 Step 1: left_op_right applied to 39 components. 5 True -&gt; provisionalreject. 34 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 1: Total component classifications: 5 provisionalreject, 34 unclassified
INFO     selection_nodes:dec_left_op_right:389 Step 2: left_op_right: provisionalreject if [&#39;countsigFS0&gt;countsigFT2 &amp; countsigFT2&gt;0&#39;], else nochange
INFO     selection_utils:log_decision_tree_step:447 Step 2: left_op_right applied to 39 components. 2 True -&gt; provisionalreject. 37 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 2: Total component classifications: 5 provisionalreject, 34 unclassified
INFO     selection_nodes:calc_median:653 Step 3: calc_median: Median(median_varex)
INFO     selection_utils:log_decision_tree_step:459 Step 3: calc_median calculated: median_varex=0.5929824670451247
INFO     selection_utils:log_classification_counts:492 Step 3: Total component classifications: 5 provisionalreject, 34 unclassified
INFO     selection_nodes:dec_left_op_right:389 Step 4: left_op_right: provisionalreject if [&#39;dice_FS0&gt;dice_FT2 &amp; variance explained&gt;0.59&#39;], else nochange
INFO     selection_utils:comptable_classification_changer:293 Step 4: No components fit criterion True to change classification
INFO     selection_utils:log_decision_tree_step:447 Step 4: left_op_right applied to 39 components. 0 True -&gt; provisionalreject. 39 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 4: Total component classifications: 5 provisionalreject, 34 unclassified
INFO     selection_nodes:dec_left_op_right:389 Step 5: left_op_right: provisionalreject if [&#39;0&gt;signal-noise_t &amp; variance explained&gt;0.59&#39;], else nochange
INFO     selection_utils:log_decision_tree_step:447 Step 5: left_op_right applied to 39 components. 4 True -&gt; provisionalreject. 35 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 5: Total component classifications: 7 provisionalreject, 32 unclassified
INFO     selection_nodes:calc_kappa_elbow:767 Step 6: calc_kappa_elbow: Calc Kappa Elbow
INFO     selection_utils:kappa_elbow_kundu:668 Calculating kappa elbow based on all components.
INFO     selection_utils:log_decision_tree_step:459 Step 6: calc_kappa_elbow calculated: kappa_elbow_kundu=72.03387706852928, kappa_allcomps_elbow=72.03387706852928, kappa_nonsig_elbow=None, varex_upper_p=0.7019602209364856
INFO     selection_utils:log_classification_counts:492 Step 6: Total component classifications: 7 provisionalreject, 32 unclassified
INFO     selection_nodes:calc_rho_elbow:902 Step 7: calc_rho_elbow: Calc Rho Elbow
INFO     selection_utils:log_decision_tree_step:459 Step 7: calc_rho_elbow calculated: rho_elbow_liberal=20.056182881485125, rho_allcomps_elbow=20.056182881485125, rho_unclassified_elbow=19.71899835703492, elbow_f05=7.708647422176786
INFO     selection_utils:log_classification_counts:492 Step 7: Total component classifications: 7 provisionalreject, 32 unclassified
INFO     selection_nodes:dec_left_op_right:389 Step 8: left_op_right: provisionalaccept if [&#39;kappa&gt;=72.03 &amp; rho&lt;20.06&#39;], else provisionalreject
INFO     selection_nodes:dec_left_op_right:391 Step 8: left_op_right If kappa&gt; kappa elbow and rho&lt;rho elbow, provisional accept. Otherwise provisional reject
INFO     selection_utils:log_decision_tree_step:447 Step 8: left_op_right applied to 32 components. 12 True -&gt; provisionalaccept. 20 False -&gt; provisionalreject.
INFO     selection_utils:log_classification_counts:492 Step 8: Total component classifications: 12 provisionalaccept, 27 provisionalreject
INFO     selection_nodes:dec_left_op_right:389 Step 9: left_op_right: provisionalaccept if [&#39;kappa&gt;2*rho &amp; kappa&gt;72.03&#39;], else nochange
INFO     selection_nodes:dec_left_op_right:391 Step 9: left_op_right If kappa&gt;elbow and kappa&gt;2*rho accept even if rho&gt;elbow
INFO     selection_utils:log_decision_tree_step:447 Step 9: left_op_right applied to 27 components. 1 True -&gt; provisionalaccept. 26 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 9: Total component classifications: 13 provisionalaccept, 26 provisionalreject
INFO     selection_nodes:dec_left_op_right:389 Step 10: left_op_right: provisionalreject if [&#39;pval nuisance model&lt;0.05 &amp; R2stat nuisance model&gt;0.5&#39;], else nochange
INFO     selection_nodes:dec_left_op_right:391 Step 10: left_op_right If external regressors fit with p&lt;0.05 and model R2&gt;0.5 of the variance, then reject.
INFO     selection_utils:log_decision_tree_step:447 Step 10: left_op_right applied to 39 components. 10 True -&gt; provisionalreject. 29 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 10: Total component classifications: 11 provisionalaccept, 28 provisionalreject
INFO     selection_nodes:dec_left_op_right:389 Step 11: left_op_right: nochange if [&#39;pval nuisance model&lt;0.05 &amp; R2stat nuisance model&gt;0.5 &amp; pval nuisance Motion partial model&lt;0.05&#39;], else nochange
INFO     selection_utils:comptable_classification_changer:293 Step 11: No components fit criterion True to change classification
INFO     selection_utils:log_decision_tree_step:447 Step 11: left_op_right applied to 28 components. 0 True -&gt; nochange. 28 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 11: Total component classifications: 11 provisionalaccept, 28 provisionalreject
INFO     selection_nodes:dec_left_op_right:389 Step 12: left_op_right: nochange if [&#39;pval nuisance model&lt;0.05 &amp; R2stat nuisance model&gt;0.5 &amp; pval nuisance CSF partial model&lt;0.05&#39;], else nochange
INFO     selection_utils:comptable_classification_changer:293 Step 12: No components fit criterion True to change classification
INFO     selection_utils:log_decision_tree_step:447 Step 12: left_op_right applied to 28 components. 0 True -&gt; nochange. 28 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 12: Total component classifications: 11 provisionalaccept, 28 provisionalreject
INFO     selection_nodes:dec_left_op_right:389 Step 13: left_op_right: accepted if [&#39;pval task model&lt;0.05 &amp; R2stat task model&gt;0.5 &amp; kappa&gt;=72.03&#39;], else nochange
INFO     selection_utils:comptable_classification_changer:293 Step 13: No components fit criterion True to change classification
INFO     selection_utils:log_decision_tree_step:447 Step 13: left_op_right applied to 28 components. 0 True -&gt; accepted. 28 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 13: Total component classifications: 11 provisionalaccept, 28 provisionalreject
INFO     selection_nodes:dec_variance_lessthan_thresholds:533 Step 14: variance_lt_thresholds: accepted if variance explained&lt;0.1. All variance&lt;1.0, else nochange
INFO     selection_utils:comptable_classification_changer:293 Step 14: No components fit criterion True to change classification
INFO     selection_utils:log_decision_tree_step:447 Step 14: variance_lt_thresholds applied to 28 components. 0 True -&gt; accepted. 28 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 14: Total component classifications: 11 provisionalaccept, 28 provisionalreject
INFO     selection_nodes:manual_classify:104 Step 15: manual_classify: Set provisionalaccept to accepted 
INFO     selection_utils:comptable_classification_changer:293 Step 15: No components fit criterion False to change classification
INFO     selection_utils:log_decision_tree_step:447 Step 15: manual_classify applied to 11 components. 11 True -&gt; accepted. 0 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 15: Total component classifications: 11 accepted, 28 provisionalreject
INFO     selection_nodes:manual_classify:104 Step 16: manual_classify: Set [&#39;provisionalreject&#39;, &#39;unclassified&#39;] to rejected 
INFO     selection_utils:comptable_classification_changer:293 Step 16: No components fit criterion False to change classification
INFO     selection_utils:log_decision_tree_step:447 Step 16: manual_classify applied to 28 components. 28 True -&gt; rejected. 0 False -&gt; nochange.
INFO     selection_utils:log_classification_counts:492 Step 16: Total component classifications: 11 accepted, 28 rejected
INFO     io:denoise_ts:613 Variance explained by decomposition: 94.68%
INFO     io:write_split_ts:700 Writing denoised time series: /home/jovyan/Git_repositories/example-notebooks/books/functional_imaging/five-echo-dataset/tedana_external_regress_processed/desc-denoised_bold.nii.gz
INFO     io:writeresults:749 Writing full ICA coefficient feature set: /home/jovyan/Git_repositories/example-notebooks/books/functional_imaging/five-echo-dataset/tedana_external_regress_processed/desc-ICA_components.nii.gz
INFO     io:writeresults:753 Writing denoised ICA coefficient feature set: /home/jovyan/Git_repositories/example-notebooks/books/functional_imaging/five-echo-dataset/tedana_external_regress_processed/desc-ICAAccepted_components.nii.gz
INFO     io:writeresults:759 Writing Z-normalized spatial component maps: /home/jovyan/Git_repositories/example-notebooks/books/functional_imaging/five-echo-dataset/tedana_external_regress_processed/desc-ICAAccepted_stat-z_components.nii.gz
INFO     tedana:tedana_workflow:1116 Making figures folder with static component maps and timecourse plots.
INFO     io:denoise_ts:613 Variance explained by decomposition: 94.68%
/opt/conda/lib/python3.11/site-packages/tedana/io.py:904: UserWarning: Data array used to create a new image contains 64-bit ints. This is likely due to creating the array with numpy and passing `int` as the `dtype`. Many tools such as FSL and SPM cannot deal with int64 in Nifti images, so for compatibility the data has been converted to int32.
  nii = new_img_like(ref_img, newdata, affine=affine, copy_header=copy_header)
/opt/conda/lib/python3.11/site-packages/tedana/io.py:904: UserWarning: Data array used to create a new image contains 64-bit ints. This is likely due to creating the array with numpy and passing `int` as the `dtype`. Many tools such as FSL and SPM cannot deal with int64 in Nifti images, so for compatibility the data has been converted to int32.
  nii = new_img_like(ref_img, newdata, affine=affine, copy_header=copy_header)
/opt/conda/lib/python3.11/site-packages/tedana/io.py:904: UserWarning: Data array used to create a new image contains 64-bit ints. This is likely due to creating the array with numpy and passing `int` as the `dtype`. Many tools such as FSL and SPM cannot deal with int64 in Nifti images, so for compatibility the data has been converted to int32.
  nii = new_img_like(ref_img, newdata, affine=affine, copy_header=copy_header)
/opt/conda/lib/python3.11/site-packages/nilearn/plotting/img_plotting.py:1416: UserWarning: Non-finite values detected. These values will be replaced with zeros.
  safe_get_data(stat_map_img, ensure_finite=True),
INFO     tedana:tedana_workflow:1172 Generating dynamic report
INFO     html_report:_update_template_bokeh:164 Checking for adaptive mask: adaptive_mask.svg, exists: True
INFO     html_report:_update_template_bokeh:204 T2* files exist: True
INFO     html_report:_update_template_bokeh:205 S0 files exist: True
INFO     html_report:_update_template_bokeh:206 RMSE files exist: True
INFO     html_report:_update_template_bokeh:212 External regressors exist: True
INFO     tedana:tedana_workflow:1175 Workflow completed
INFO     utils:log_newsletter_info:705 Don&#39;t forget to subscribe to the tedana newsletter for updates! This is a very low volume email list.
INFO     utils:log_newsletter_info:709 https://groups.google.com/g/tedana-newsletter
</pre></div>
</div>
</div>
</div>
</section>
<section id="components-of-the-tedana-report-of-5-echo-data-with-external-regressors">
<h2>Components of the tedana report of 5 echo data with external regressors<a class="headerlink" href="#components-of-the-tedana-report-of-5-echo-data-with-external-regressors" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here is the path to the second TEDANA report</span>
<span class="n">url</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">dset_dir5_extern_out</span> <span class="o">+</span> <span class="s1">&#39;/tedana_report.html&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/jovyan/Git_repositories/example-notebooks/books/functional_imaging/five-echo-dataset/tedana_external_regress_processed/tedana_report.html
</pre></div>
</div>
</div>
</div>
<p>To view this report with all figures displayed properly, right-click the file path and choose <strong>Open in New Browser Tab</strong>.</p>
<section id="id1">
<h3>Carpet plot<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;five-echo-dataset/tedana_external_regress_processed/figures/carpet_optcom.svg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a3e1f9ca9ccf9e6f9a647d41bcdcba2e26e599a9a16dd7db16581e9e33fcb330.svg" src="../../_images/a3e1f9ca9ccf9e6f9a647d41bcdcba2e26e599a9a16dd7db16581e9e33fcb330.svg" />
</div>
</div>
</section>
<section id="id2">
<h3>Adaptive Mask<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;five-echo-dataset/tedana_external_regress_processed/figures/adaptive_mask.svg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f5feb01dac820c2741064223785d215e291e3ae9455c23255f56c34f2baf988b.svg" src="../../_images/f5feb01dac820c2741064223785d215e291e3ae9455c23255f56c34f2baf988b.svg" />
</div>
</div>
</section>
<section id="id3">
<h3>T2*<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2star_brain</span> <span class="o">=</span> <span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;five-echo-dataset/tedana_external_regress_processed/figures/t2star_brain.svg&#39;</span><span class="p">)</span>
<span class="n">t2star_histogram</span> <span class="o">=</span> <span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;five-echo-dataset/tedana_external_regress_processed/figures/t2star_histogram.svg&#39;</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">t2star_brain</span><span class="p">,</span> <span class="n">t2star_histogram</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2f0cac669c77b4748a64d7b9084893510f9d3d6089862c25bc9f0817b8d97f20.svg" src="../../_images/2f0cac669c77b4748a64d7b9084893510f9d3d6089862c25bc9f0817b8d97f20.svg" />
<img alt="../../_images/3ff125ab89038ad30f060bad9f0f37b63af59bf89db3e987f7864efd87d9b77d.svg" src="../../_images/3ff125ab89038ad30f060bad9f0f37b63af59bf89db3e987f7864efd87d9b77d.svg" />
</div>
</div>
</section>
<section id="id4">
<h3>S0<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s0_brain</span> <span class="o">=</span> <span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;five-echo-dataset/tedana_external_regress_processed/figures/s0_brain.svg&#39;</span><span class="p">)</span>
<span class="n">s0_histogram</span> <span class="o">=</span> <span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;five-echo-dataset/tedana_external_regress_processed/figures/s0_histogram.svg&#39;</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">s0_brain</span><span class="p">,</span> <span class="n">s0_histogram</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/414fcbd9cfa51902fc2f5357e0a536c4292d90477bc09404bd1dec3d628d4fd9.svg" src="../../_images/414fcbd9cfa51902fc2f5357e0a536c4292d90477bc09404bd1dec3d628d4fd9.svg" />
<img alt="../../_images/eb768fdcbeeb020a56317541f0ce7657ee04b31058ebf57e15c6b529eb519126.svg" src="../../_images/eb768fdcbeeb020a56317541f0ce7657ee04b31058ebf57e15c6b529eb519126.svg" />
</div>
</div>
</section>
<section id="id5">
<h3>T2* and S0 model fit (RMSE). (Scaled between 2nd and 98th percentiles)<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rmse_brain</span> <span class="o">=</span> <span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;five-echo-dataset/tedana_external_regress_processed/figures/rmse_brain.svg&#39;</span><span class="p">)</span>
<span class="n">rmse_timeseries</span> <span class="o">=</span> <span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;five-echo-dataset/tedana_external_regress_processed/figures/rmse_timeseries.svg&#39;</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">rmse_brain</span><span class="p">,</span> <span class="n">rmse_timeseries</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9b54ec11210c2909e606ab0c7c445b3f6c8bc257fb14fcb40245db950eb71d74.svg" src="../../_images/9b54ec11210c2909e606ab0c7c445b3f6c8bc257fb14fcb40245db950eb71d74.svg" />
<img alt="../../_images/b06d30398f5d158cb9fc48111849d1108a072ced6ce38ff087547cf63997b2de.svg" src="../../_images/b06d30398f5d158cb9fc48111849d1108a072ced6ce38ff087547cf63997b2de.svg" />
</div>
</div>
</section>
<section id="external-regressors">
<h3>External regressors<a class="headerlink" href="#external-regressors" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;five-echo-dataset/tedana_external_regress_processed/figures/confound_correlations.svg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e0c3a92b630a91d066675a39c14c6b302b5bd0df5036cd3e8bb4110bbde8f84b.svg" src="../../_images/e0c3a92b630a91d066675a39c14c6b302b5bd0df5036cd3e8bb4110bbde8f84b.svg" />
</div>
</div>
</section>
<section id="dependencies-in-jupyter-python">
<h3>Dependencies in Jupyter/Python<a class="headerlink" href="#dependencies-in-jupyter-python" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Using the package <a class="reference external" href="https://github.com/rasbt/watermark">watermark</a> to document system environment and software versions used in this notebook</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> watermark

<span class="o">%</span><span class="k">watermark</span>
<span class="o">%</span><span class="k">watermark</span> --iversions
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Last updated: 2025-11-04T00:39:51.384745+00:00

Python implementation: CPython
Python version       : 3.11.6
IPython version      : 8.16.1

Compiler    : GCC 12.3.0
OS          : Linux
Release     : 5.4.0-204-generic
Machine     : x86_64
Processor   : x86_64
CPU cores   : 32
Architecture: 64bit

tedana : 25.0.1
IPython: 8.16.1
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./examples/functional_imaging"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="mri_vol2surf.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">FreeSurfer: mri_vol2surf</p>
      </div>
    </a>
    <a class="right-next"
       href="../spectroscopy/intro.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Spectroscopy</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#process-five-echo-flashing-checkerboard-dataset-for-software-demo">Process five-echo flashing checkerboard dataset for software demo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#citation">Citation:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tools-included-in-this-workflow">Tools included in this workflow</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#publications">Publications</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#educational-resources">Educational resources</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset">Dataset</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-5-echo-data">Download 5 echo data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-workflow-on-5-echo-data">Run workflow on 5 echo data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tedana-report-of-5-echo-data">Tedana report of 5 echo data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carpet-plot">Carpet plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adaptive-mask">Adaptive Mask</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t2">T2*</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#s0">S0</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t2-and-s0-model-fit-rmse-scaled-between-2nd-and-98th-percentiles">T2* and S0 model fit (RMSE). (Scaled between 2nd and 98th percentiles)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-generation-using-afni-commands">Time series generation using AFNI commands</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-workflow-on-5-echo-data-using-existing-mixing-matrix-and-external-regressors">Run workflow on 5 echo data using existing mixing matrix and external regressors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#components-of-the-tedana-report-of-5-echo-data-with-external-regressors">Components of the tedana report of 5 echo data with external regressors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Carpet plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Adaptive Mask</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">T2*</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">S0</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">T2* and S0 model fit (RMSE). (Scaled between 2nd and 98th percentiles)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#external-regressors">External regressors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies-in-jupyter-python">Dependencies in Jupyter/Python</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Neurodesk Team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>