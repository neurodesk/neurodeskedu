
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Getting started &#8212; Neurodesk</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-4Z9774J59Y"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-4Z9774J59Y');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-4Z9774J59Y');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/functional_imaging/physio_batch_workflow';</script>
    <link rel="canonical" href="https://neurodesk.github.io/neurodel/tutorials/functional_imaging/physio_batch_workflow.html" />
    <link rel="icon" href="../../_static/neurodesk_logo.svg"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Download data" href="spm.html" />
    <link rel="prev" title="Origin" href="physio.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/neurodesk_logo.svg" class="logo__image only-light" alt="Neurodesk - Home"/>
    <script>document.write(`<img src="../../_static/neurodesk_logo.svg" class="logo__image only-dark" alt="Neurodesk - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    NeurodEL
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Workflows</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../workflows/AA_Neurodesk_demo_tour.html">Neurodesk Tools Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflows/MRIQC.html">MRIQC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflows/PyBIDS.html">PyBIDS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflows/RISE_slideshow.html">RISE Slideshow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflows/bids_conversion.html">BIDS conversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflows/nipype_full.html">Nipype on Neurodesk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflows/nipype_short.html">Basic Nipype</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../workflows/papermill-slurm-submission-example.html">Papermill Slurm Job Submission</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflows/pydra_preproc_ants.html">Pydra</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Structural Imaging</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../structural_imaging/FSL_course_bet.html">FSL course - BET</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../structural_imaging/brain_extraction_different_tools.html">Brain Extraction Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../structural_imaging/freesurfer.html">FreeSurfer</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../structural_imaging/qsmxt.html">QSMxT</a></li>







<li class="toctree-l1"><a class="reference internal" href="../../structural_imaging/sct_toolbox.html">SCT Toolbox</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Spectroscopy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../spectroscopy/lcmodel.html">MR Spectroscopy with LCModel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../spectroscopy/osprey.html">MR Spectroscopy with Osprey</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Diffusion Imaging</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../diffusion_imaging/Diffusion_TBSS_Demo.html">TBSS Tutorial</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../diffusion_imaging/MRtrix_1.html">MRtrix: Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../diffusion_imaging/MRtrix_2.html">MRtrix: Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../diffusion_imaging/MRtrix_3.html">MRtrix: Part 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../diffusion_imaging/mrtrix3tissue.html">MRtrix3Tissue</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Functional Imaging</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../functional_imaging/AFNI_preprocessing_only.html">AFNI Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional_imaging/AFNI_preprocessing_plus_glm.html">AFNI Preprocessing and GLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional_imaging/AFNI_preprocessing_plus_glm_group.html">AFNI Preprocessing &amp; Group Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional_imaging/FSL_preproc_glm.html">FSL Preprocessing and GLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional_imaging/FSLnets_course_practical.html">Resting state with FSLnets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional_imaging/NiWrap.html">NiWrap and Connectome Workbench</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional_imaging/aslprep.html">ASLprep</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional_imaging/deepretinotopy.html">DeepRetinotopy</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../functional_imaging/first_and_second_level_spm.html">Nipype-SPM fMRI Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional_imaging/fmriprep.html">fMRIprep</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional_imaging/fsl_all_levels_flanker_nipype.html">Nipype-FSL fMRI Analysis</a></li>



<li class="toctree-l1"><a class="reference internal" href="../../functional_imaging/intro_to_preprocessing.html">Introduction to Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional_imaging/mri_vol2surf.html">FreeSurfer: mri_vol2surf</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional_imaging/process_five_echo_dataset.html">tedana: TE Dependent ANAlysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Electrophysiology</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../electrophysiology/eeg_with_mne.html">EEG Analysis with MNE</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../electrophysiology/EEG_mne-python.html">Analysing EEG Data with MNE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../electrophysiology/fieldtrip.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="connectomeWorkbench.html">Download data</a></li>

<li class="toctree-l1"><a class="reference internal" href="fmriprep.html">Assumptions</a></li>

<li class="toctree-l1"><a class="reference internal" href="mriqc.html">Assumptions</a></li>

<li class="toctree-l1"><a class="reference internal" href="physio.html">Origin</a></li>





<li class="toctree-l1 current active"><a class="current reference internal" href="#">Getting started</a></li>



<li class="toctree-l1"><a class="reference internal" href="spm.html">Download data</a></li>



<li class="toctree-l1"><a class="reference internal" href="../open_data/datalad.html">Publish a dataset</a></li>

<li class="toctree-l1"><a class="reference internal" href="../open_data/osfclient.html">Setup an OSF token</a></li>


<li class="toctree-l1"><a class="reference internal" href="../phase_processing/swi.html">Download demo data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../phase_processing/unwrapping.html">Download demo data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming/conda.html">Conda/Mamba environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming/matlab.html">Matlab license</a></li>


<li class="toctree-l1"><a class="reference internal" href="../reproducibility/datalad-run.html">Create a DataLad project</a></li>




<li class="toctree-l1"><a class="reference internal" href="../spectroscopy/mrsiproc.html">Starting Neurodesk</a></li>


<li class="toctree-l1"><a class="reference internal" href="../structural_imaging/freesurfer.html">FreeSurfer Example using module load (e.g. on an HPC)</a></li>

<li class="toctree-l1"><a class="reference internal" href="../structural_imaging/structuralconnectivity.html">References:</a></li>







</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/neurodesk/neurodel" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/neurodesk/neurodel/edit/main/books/tutorials/functional_imaging/physio_batch_workflow.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/neurodesk/neurodel/issues/new?title=Issue%20on%20page%20%2Ftutorials/functional_imaging/physio_batch_workflow.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/tutorials/functional_imaging/physio_batch_workflow.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Getting started</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Getting started</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-an-example-script-for-batching">1. Generate an example script for batching</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#generalise-the-script-for-use-with-any-participant">2. Generalise the script for use with any participant</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ready-to-run-on-neurodesk">3. Ready to run on Neurodesk!</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <blockquote>
<div><p><em>This tutorial was created by Kelly G. Garner.</em></p>
<p>Github: &#64;kel-github</p>
<p>Twitter: &#64;garner_theory</p>
</div></blockquote>
<!-- Following line adds a link to getting set up with Neurodesk -->
<p><a class="reference internal" href="../../intro.html"><span class="std std-doc">Getting Set Up with Neurodesk</span></a></p>
<!-- -->
<p>This tutorial walks through 1 way to batch script the use of the PhysIO toolbox with Neurodesk.
The goal is to use the toolbox to generate physiological regressors to use when modelling fMRI data.
The output format of the regressor files are directly compatible for use with SPM, and can be adapted to fit the specifications of other toolboxes. <p></p>
<section class="tex2jax_ignore mathjax_ignore" id="getting-started">
<h1>Getting started<a class="headerlink" href="#getting-started" title="Link to this heading">#</a></h1>
<p>This tutorial assumes the following:</p>
<ol class="arabic simple">
<li><p>Your data are (largely) in <a class="reference external" href="https://bids.neuroimaging.io/">BIDS format</a></p></li>
<li><p>That you have converted your .zip files containing physiological data to .log files. For example, if you’re using a CMRR multi-band sequence, then you can use <a class="reference external" href="https://github.com/CMRR-C2P/MB/blob/master/readCMRRPhysio.m">this function</a></p></li>
<li><p>That your .log files are in the subject derivatives/…/sub-…/ses-…/’func’ folders of aforementioned BIDs structured data</p></li>
<li><p>That you have a file that contains the motion regressors you plan to use in your GLM. I’ll talk below a bit about what I did with the output given by fmriprep (e.g. …_desc-confounds_timeseries.tsv’)</p></li>
<li><p>That you can use SPM12 and the PhysIO GUI to initialise your batch code</p></li>
</ol>
<p>NB. You can see the code generated from this tutorial <a class="reference external" href="https://github.com/garner-code/imaging_cert_value_7T_pipeline/tree/master/physiol_regress">here</a> <p></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="generate-an-example-script-for-batching">
<h1>1. Generate an example script for batching<a class="headerlink" href="#generate-an-example-script-for-batching" title="Link to this heading">#</a></h1>
<p>First you will create an example batch script that is specific to one of your participants. To achieve this I downloaded locally the relevant ‘.log’ files for one participant, as well as the ‘…desc-confounds_timeseries.tsv’ output for fmriprep for each run. PhysIO is nice in that it will append the regressors from your physiological data to your movement parameters, so that you have a single file of regressors to add to your design matrix in SPM etc (other toolboxes are available). <p></p>
<p>To work with PhysIO toolbox, your motion parameters need to be in the .txt format as required by SPM.</p>
<p>I made some simple functions in python that would extract my desired movement regressors and save them to the space separated .txt file as is required by SPM. They can be found <a class="reference external" href="https://github.com/garner-code/imaging_cert_value_7T_pipeline/tree/master/physiol_regress/get_movement_regressors">here</a>.</p>
<p>Once I had my .log files and .txt motion regressors file, I followed the instructions <a class="reference external" href="https://gitlab.ethz.ch/physio/physio-doc/-/wikis/QUICKSTART">here</a> to get going with the Batch editor, and used <a class="reference external" href="https://doi.org/10.1016/j.jneumeth.2016.10.019">this paper</a> to aid my understanding of how to complete the fields requested by the Batch editor.</p>
<p>I wound up with a Batch script for the PhysIO toolbox that looked a little bit like this:</p>
<p><img alt="PhysIOBatch1" src="static/tutorials-examples/tutorials/functional_imaging/PhysIO_Batch/PhysIOBatch1.png" /> <!-- ![filename without extension](/subfolder_name/filename.png '[filename without extension')  --></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="generalise-the-script-for-use-with-any-participant">
<h1>2. Generalise the script for use with any participant<a class="headerlink" href="#generalise-the-script-for-use-with-any-participant" title="Link to this heading">#</a></h1>
<p>Now that you have an example script that contains the specific details for a single participant, you are ready to generalise this code so that you can run it for any participant you choose. I decided to do this by doing the following:</p>
<ul class="simple">
<li><p>First I generate an ‘info’ structure for each participant. This is a structure saved as a matfile for each participant under ‘derivatives’, in the relevant sub-z/ses-y/func/ folder. This structure contains the subject specific details that PhysIO needs to know to run. Thus I wrote a matlab function that saves a structure called info with the following fields:</p></li>
</ul>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% -- outputs: a matfile containing a structure called info with the</span>
<span class="c">% following fields:</span>
<span class="c">%    -- sub_num = subject number: [string] of form &#39;01&#39; &#39;11&#39; or &#39;111&#39;</span>
<span class="c">%    -- sess = session number: [integer] e.g. 2</span>
<span class="c">%    -- nrun = [integer] number of runs for that participant</span>
<span class="c">%    -- nscans = number of scans (volumes) in the design matrix for each</span>
<span class="c">%    run [1, nrun]</span>
<span class="c">%    -- cardiac_files = a cell of the cardiac files for that participant</span>
<span class="c">%    (1,n = nrun) - attained by using extractCMRRPhysio()</span>
<span class="c">%    -- respiration_files = same as above but for the resp files - attained by using extractCMRRPhysio()</span>
<span class="c">%    -- scan_timing = info file from Siemens - attained by using extractCMRRPhysio()</span>
<span class="c">%    -- movement = a cell of the movement regressor files for that</span>
<span class="c">%    participant (.txt, formatted for SPM)</span>
</pre></div>
</div>
<p>To see the functions that produce this information, you can go to this <a class="reference external" href="https://github.com/garner-code/imaging_cert_value_7T_pipeline/tree/master/physiol_regress">repo here</a></p>
<ul class="simple">
<li><p>Next I amended the batch script to load a given participant’s info file and to retrieve this information for the required fields in the batch. The batch script winds up looking like this:</p></li>
</ul>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%% written by K. Garner, 2022</span>
<span class="c">% uses batch info:</span>
<span class="c">%-----------------------------------------------------------------------</span>
<span class="c">% Job saved on 17-Aug-2021 10:35:05 by cfg_util (rev $Rev: 7345 $)</span>
<span class="c">% spm SPM - SPM12 (7771)</span>
<span class="c">% cfg_basicio BasicIO - Unknown</span>
<span class="c">%-----------------------------------------------------------------------</span>
<span class="c">% load participant info, and print into the appropriate batch fields below</span>
<span class="c">% before running spm jobman</span>
<span class="c">% assumes data is in BIDS format</span>

<span class="c">%% load participant info</span>
<span class="n">sub</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;01&#39;</span><span class="p">;</span>
<span class="n">dat_path</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;/file/path/to/top-level/of-your-derivatives-fmriprep/folder&#39;</span><span class="p">;</span>
<span class="n">task</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;attlearn&#39;</span><span class="p">;</span>
<span class="nb">load</span><span class="p">(</span><span class="nb">fullfile</span><span class="p">(</span><span class="n">dat_path</span><span class="p">,</span><span class="w"> </span><span class="nb">sprintf</span><span class="p">(</span><span class="s">&#39;sub-%s&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">sub</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;ses-02&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;func&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">              </span><span class="nb">sprintf</span><span class="p">(</span><span class="s">&#39;sub-%s_ses-02_task-%s_desc-physioinfo&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">sub</span><span class="p">,</span><span class="w"> </span><span class="n">task</span><span class="p">)))</span>
<span class="w">          </span>
<span class="c">% set variables</span>
<span class="n">nrun</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">nrun</span><span class="p">;</span>
<span class="n">nscans</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">nscans</span><span class="p">;</span>
<span class="n">cardiac_files</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">cardiac_files</span><span class="p">;</span>
<span class="n">respiration_files</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">respiration_files</span><span class="p">;</span>
<span class="n">scan_timing</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">scan_timing</span><span class="p">;</span>
<span class="n">movement</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">movement</span><span class="p">;</span>
<span class="w">          </span>
<span class="c">%% initialise spm</span>
<span class="n">spm_jobman</span><span class="p">(</span><span class="s">&#39;initcfg&#39;</span><span class="p">);</span><span class="w"> </span><span class="c">% check this for later</span>
<span class="n">spm</span><span class="p">(</span><span class="s">&#39;defaults&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;FMRI&#39;</span><span class="p">);</span>
<span class="w">          </span>
<span class="c">%% run through runs, print info and run </span>

<span class="k">for</span><span class="w"> </span><span class="n">irun</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">nrun</span>
<span class="w">    </span>
<span class="w">    </span><span class="nb">clear</span><span class="w"> </span><span class="n">matlabbatch</span>

<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">save_dir</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">cellstr</span><span class="p">(</span><span class="nb">fullfile</span><span class="p">(</span><span class="n">dat_path</span><span class="p">,</span><span class="w"> </span><span class="nb">sprintf</span><span class="p">(</span><span class="s">&#39;sub-%s&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">sub</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;ses-02&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;func&#39;</span><span class="p">));</span><span class="w"> </span><span class="c">% 1</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">log_files</span><span class="p">.</span><span class="n">vendor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;Siemens_Tics&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">log_files</span><span class="p">.</span><span class="n">cardiac</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cardiac_files</span><span class="p">(</span><span class="n">irun</span><span class="p">);</span><span class="w"> </span><span class="c">% 2</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">log_files</span><span class="p">.</span><span class="n">respiration</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">respiration_files</span><span class="p">(</span><span class="n">irun</span><span class="p">);</span><span class="w"> </span><span class="c">% 3</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">log_files</span><span class="p">.</span><span class="n">scan_timing</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">scan_timing</span><span class="p">(</span><span class="n">irun</span><span class="p">);</span><span class="w"> </span><span class="c">% 4</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">log_files</span><span class="p">.</span><span class="n">sampling_interval</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">log_files</span><span class="p">.</span><span class="n">relative_start_acquisition</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">log_files</span><span class="p">.</span><span class="n">align_scan</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;last&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">scan_timing</span><span class="p">.</span><span class="n">sqpar</span><span class="p">.</span><span class="n">Nslices</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">81</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">scan_timing</span><span class="p">.</span><span class="n">sqpar</span><span class="p">.</span><span class="n">NslicesPerBeat</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">scan_timing</span><span class="p">.</span><span class="n">sqpar</span><span class="p">.</span><span class="n">TR</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">1.51</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">scan_timing</span><span class="p">.</span><span class="n">sqpar</span><span class="p">.</span><span class="n">Ndummies</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">scan_timing</span><span class="p">.</span><span class="n">sqpar</span><span class="p">.</span><span class="n">Nscans</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nscans</span><span class="p">(</span><span class="n">irun</span><span class="p">);</span><span class="w"> </span><span class="c">% 5</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">scan_timing</span><span class="p">.</span><span class="n">sqpar</span><span class="p">.</span><span class="n">onset_slice</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">scan_timing</span><span class="p">.</span><span class="n">sqpar</span><span class="p">.</span><span class="n">time_slice_to_slice</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">scan_timing</span><span class="p">.</span><span class="n">sqpar</span><span class="p">.</span><span class="n">Nprep</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">scan_timing</span><span class="p">.</span><span class="n">sync</span><span class="p">.</span><span class="n">nominal</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">struct</span><span class="p">([]);</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">preproc</span><span class="p">.</span><span class="n">cardiac</span><span class="p">.</span><span class="n">modality</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;PPU&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">preproc</span><span class="p">.</span><span class="n">cardiac</span><span class="p">.</span><span class="n">filter</span><span class="p">.</span><span class="n">no</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">struct</span><span class="p">([]);</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">preproc</span><span class="p">.</span><span class="n">cardiac</span><span class="p">.</span><span class="n">initial_cpulse_select</span><span class="p">.</span><span class="n">auto_template</span><span class="p">.</span><span class="n">min</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.4</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">preproc</span><span class="p">.</span><span class="n">cardiac</span><span class="p">.</span><span class="n">initial_cpulse_select</span><span class="p">.</span><span class="n">auto_template</span><span class="p">.</span><span class="n">file</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;initial_cpulse_kRpeakfile.mat&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">preproc</span><span class="p">.</span><span class="n">cardiac</span><span class="p">.</span><span class="n">initial_cpulse_select</span><span class="p">.</span><span class="n">auto_template</span><span class="p">.</span><span class="n">max_heart_rate_bpm</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">90</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">preproc</span><span class="p">.</span><span class="n">cardiac</span><span class="p">.</span><span class="n">posthoc_cpulse_select</span><span class="p">.</span><span class="n">off</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">struct</span><span class="p">([]);</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">preproc</span><span class="p">.</span><span class="n">respiratory</span><span class="p">.</span><span class="n">filter</span><span class="p">.</span><span class="n">passband</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.01</span><span class="w"> </span><span class="mi">2</span><span class="p">];</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">preproc</span><span class="p">.</span><span class="n">respiratory</span><span class="p">.</span><span class="n">despike</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">output_multiple_regressors</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;mregress.txt&#39;</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">output_physio</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;physio&#39;</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">orthogonalise</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;none&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">censor_unreliable_recording_intervals</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w"> </span><span class="c">%false; </span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">retroicor</span><span class="p">.</span><span class="n">yes</span><span class="p">.</span><span class="n">order</span><span class="p">.</span><span class="n">c</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">retroicor</span><span class="p">.</span><span class="n">yes</span><span class="p">.</span><span class="n">order</span><span class="p">.</span><span class="n">r</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">retroicor</span><span class="p">.</span><span class="n">yes</span><span class="p">.</span><span class="n">order</span><span class="p">.</span><span class="n">cr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">rvt</span><span class="p">.</span><span class="n">no</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">struct</span><span class="p">([]);</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">hrv</span><span class="p">.</span><span class="n">no</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">struct</span><span class="p">([]);</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">noise_rois</span><span class="p">.</span><span class="n">no</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">struct</span><span class="p">([]);</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">movement</span><span class="p">.</span><span class="n">yes</span><span class="p">.</span><span class="n">file_realignment_parameters</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="nb">fullfile</span><span class="p">(</span><span class="n">dat_path</span><span class="p">,</span><span class="w"> </span><span class="nb">sprintf</span><span class="p">(</span><span class="s">&#39;sub-%s&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">sub</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;ses-02&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;func&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">sprintf</span><span class="p">(</span><span class="s">&#39;sub-%s_ses-02_task-%s_run-%d_desc-motion_timeseries.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">sub</span><span class="p">,</span><span class="w"> </span><span class="n">task</span><span class="p">,</span><span class="w"> </span><span class="n">irun</span><span class="p">))};</span><span class="w"> </span><span class="c">%8</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">movement</span><span class="p">.</span><span class="n">yes</span><span class="p">.</span><span class="n">order</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">movement</span><span class="p">.</span><span class="n">yes</span><span class="p">.</span><span class="n">censoring_method</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;FD&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">movement</span><span class="p">.</span><span class="n">yes</span><span class="p">.</span><span class="n">censoring_threshold</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">other</span><span class="p">.</span><span class="n">no</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">struct</span><span class="p">([]);</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">verbose</span><span class="p">.</span><span class="n">level</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">verbose</span><span class="p">.</span><span class="n">fig_output_file</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">matlabbatch</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">spm</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="n">physio</span><span class="p">.</span><span class="n">verbose</span><span class="p">.</span><span class="n">use_tabs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">    </span>
<span class="w">    </span><span class="n">spm_jobman</span><span class="p">(</span><span class="s">&#39;run&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">matlabbatch</span><span class="p">);</span>

<span class="k">end</span>
</pre></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ready-to-run-on-neurodesk">
<h1>3. Ready to run on Neurodesk!<a class="headerlink" href="#ready-to-run-on-neurodesk" title="Link to this heading">#</a></h1>
<p>Now we have a batch script, we’re ready to run this on Neurodesk - yay! <p></p>
<p>First make sure the details at the top of the script are correct. You can see that this script could easily be amended to run multiple subjects.</p>
<p>On Neurodesk, go to the PhysIO toolbox, but select the command line tool rather than the GUI interface (‘physio r7771 instead of physioGUI r7771). This will take you to the container for the PhysIO toolbox <p></p>
<p><img alt="PhysIOBatch2" src="static/tutorials-examples/tutorials/functional_imaging/PhysIO_Batch/PhysIOBatch2.png" /> <!-- ![filename without extension](/subfolder_name/filename.png '[filename without extension')  --></p>
<p>Now to run your PhysIO batch script, type the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">run_spm12</span><span class="o">.</span><span class="n">sh</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">mcr</span><span class="o">/</span><span class="n">v99</span><span class="o">/</span> <span class="n">batch</span> <span class="o">/</span><span class="n">your</span><span class="o">/</span><span class="n">batch</span><span class="o">/</span><span class="n">script</span><span class="o">/</span><span class="n">named_something</span><span class="o">.</span><span class="n">m</span>

</pre></div>
</div>
<p>Et Voila! Physiological regressors are now yours - mua ha ha!</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./tutorials/functional_imaging"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="physio.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Origin</p>
      </div>
    </a>
    <a class="right-next"
       href="spm.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Download data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Getting started</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-an-example-script-for-batching">1. Generate an example script for batching</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#generalise-the-script-for-use-with-any-participant">2. Generalise the script for use with any participant</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ready-to-run-on-neurodesk">3. Ready to run on Neurodesk!</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Neurodesk Team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>